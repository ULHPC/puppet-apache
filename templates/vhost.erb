################################################################################
# <%= real_documentroot %> 
# Apache configuration for http://<%= scope.lookupvar('servername') %>
#
################################################################################
#" /!\ DO NOT EDIT THIS FILE: it has been automatically generated by Puppet.
#      In particular, any further changes will be overwritten at the next puppet
#      invocation
################################################################################

<VirtualHost <%= vhost_name %>:<%= port %>>
    ServerName      <%= servername %>
<% aliases.each do |serveralias| -%>
    ServerAlias     <%= serveralias %>
<% end -%>
    ServerAdmin     <%= real_serveradmin %>
    
    # Limit available info about this server.
    ServerSignature Off
    SSLEngine       Off

<% if use_ssl -%>
    # Automatic HTTP to HTTPS redirection
    RewriteEngine   on
    RewriteCond     %{SERVER_PORT} ^80$
    RewriteRule     ^(.*)$ https://%{SERVER_NAME}$1 [L,R]
<% else -%>
    DocumentRoot <%= real_documentroot %> 
    <Directory <%= real_documentroot %>>
        Options       <%= options %>
        AllowOverride None
<% if allow_from == [] -%>
        Order         allow,deny
        Allow from    all
<% else -%>
        Order Deny,Allow
        Deny from all
<% allow_from.each do |ipaddr| -%>
        Allow from <%= ipaddr %>
<% end -%>
<% end -%>
    </Directory>

    # CGI scripts
    ScriptAlias /cgi-bin/ <%= scope.lookupvar('apache::params::wwwdir') %>/<%= servername %>/cgi-bin/
    <Directory <%= scope.lookupvar('apache::params::wwwdir') %>/<%= servername %>/cgi-bin>
        Options       +ExecCGI
        AddHandler    cgi-script .cgi
    </Directory>
 <% end -%>

    ErrorLog <%= scope.lookupvar('apache::params::logdir') %>/<%= servername %>_error.log
    # Possible values include: debug, info, notice, warn, error, crit,
    # alert, emerg.
    LogLevel warn
    CustomLog <%= scope.lookupvar('apache::params::logdir') %>/<%= servername %>_access.log combined
</VirtualHost>

