################################################################################
# <%= @real_documentroot %>
# Apache configuration for http://<%= scope.lookupvar('servername') %>
#
################################################################################
#" /!\ DO NOT EDIT THIS FILE: it has been automatically generated by Puppet.
#      In particular, any further changes will be overwritten at the next puppet
#      invocation
################################################################################

<VirtualHost<% @vhost_name.each do |vhost| -%> <%= @vhost %>:<%= @port %><% end -%>>
    ServerName      <%= @servername %>
<% @aliases.each do |serveralias| -%>
    ServerAlias     <%= serveralias %>
<% end -%>
    ServerAdmin     <%= @real_serveradmin %>

    # Limit available info about this server.
    ServerSignature Off
    <IfModule mod_ssl.c>
    SSLEngine       Off
    </IfModule>

<% if @use_ssl and @redirect_ssl -%>
    # Automatic HTTP to HTTPS redirection
    RewriteEngine   on
    RewriteCond     %{SERVER_PORT} ^80$
    RewriteRule     ^(.*)$ https://%{SERVER_NAME}$1 [L,R]
<% else -%>
 <% if @passenger_app_root != '' -%>
    PassengerAppRoot <%= @passenger_app_root %>
 <% end -%>
    DocumentRoot <%= @real_documentroot %>
    <Directory <%= @real_documentroot %>>
        Options       <%= @options %>
        AllowOverride <%= @allow_override %>
 <% if @allow_from == [] -%>
        Order         allow,deny
        Allow from    all
 <% else -%>
        Order Deny,Allow
  <% @allow_from.each do |ipaddr| -%>
        Allow from <%= ipaddr %>
  <% end -%>
        Deny from all
 <% end -%>
    </Directory>

 <% if @enable_cgi -%>
    # CGI scripts
    ScriptAlias /cgi-bin/ <%= scope.lookupvar('apache::params::wwwdir') %>/<%= @servername %>/cgi-bin/
    <Directory <%= scope.lookupvar('apache::params::wwwdir') %>/<%= @servername %>/cgi-bin>
        Options       +ExecCGI
        AddHandler    cgi-script .cgi
    </Directory>
 <% end -%>
<% end -%>


